create or alter procedure INT_PROC_REGLAS
returns (
    CODIGOREGLA varchar(15),
    CODIGOTIPOENVIO smallint,
    TIPOENVIO varchar(15),
    CODIGOMEDIOENVIO smallint,
    MEDIOENVIO varchar(15),
    RECORDATORIO smallint,
    ACTIVO smallint,
    FECHAULTIMOENVIO date,
    FECHAPROXIMOENVIO date,
    CANTIDADDIAS double precision,
    MENSAJE varchar(2000))
as
begin

  for select R.CODIGOREGLA, R.CODIGOTIPOENVIO, T.DESCRIPCION, R.CODIGOMEDIOENVIO, M.DESCRIPCION, R.RECORDATORIO,
             R.ACTIVO, R.FECHAULTIMOENVIO, R.FECHAULTIMOENVIO + RECORDATORIO,
             (R.FECHAULTIMOENVIO - current_timestamp) * -1, R.MENSAJE
      from INT_REGLAS R
      inner join INT_TIPOSENVIOS T on T.CODIGOTIPOENVIO = R.CODIGOTIPOENVIO
      inner join INT_MEDIOSENVIOS M on M.CODIGOMEDIOENVIO = R.CODIGOMEDIOENVIO

      into :CODIGOREGLA, :CODIGOTIPOENVIO, :TIPOENVIO, :CODIGOMEDIOENVIO, :MEDIOENVIO, :RECORDATORIO, :ACTIVO,
           :FECHAULTIMOENVIO, :FECHAPROXIMOENVIO, :CANTIDADDIAS, :MENSAJE

  do
  begin
    suspend;
  end

end